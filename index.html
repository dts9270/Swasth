<!DOCTYPE html>
<html lang="mr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mission 1 Lakh - Full AI Report</title>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <style>
    /* BASIC STYLES */
    body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #f0f4f8; }
    
    /* LOADER */
    #loaderOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.9); z-index: 2000; display: none; justify-content: center; align-items: center; flex-direction: column; }
    .spinner { border: 5px solid #f3f3f3; border-top: 5px solid #0057b7; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* UPLOAD MODAL */
    #uploadModal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; justify-content: center; align-items: center; }
    .modal-content { background: white; padding: 25px; border-radius: 10px; width: 90%; max-width: 400px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    .close-btn { float: right; font-size: 24px; cursor: pointer; font-weight: bold; color: #555; }

    /* PROGRESS BAR */
    .progress-container { width: 100%; background-color: #f3f3f3; border-radius: 5px; margin-top: 15px; display: none; height: 20px; overflow: hidden; }
    .progress-bar { width: 0%; height: 100%; background-color: #28a745; text-align: center; line-height: 20px; color: white; font-size: 12px; transition: width 0.2s; }

    /* HEADER */
    .header { background: linear-gradient(90deg, #0052d4, #4364f7, #6fb1fc); padding: 15px; text-align: center; color: white; }
    
    /* TABS */
    .tab-btns { display: flex; justify-content: center; gap: 5px; background: #fff; padding: 10px; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .tab-btns button { padding: 10px 10px; border: none; background: #e0e0e0; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 13px; transition: 0.3s; flex: 1; }
    .tab-btns button.active-btn { background: #0057b7; color: white; }

    /* CONTAINER */
    .container { width: 95%; max-width: 950px; margin: 15px auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); min-height: 500px; }
    .tab { display: none; }
    .active { display: block; animation: fadeIn 0.3s; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* FORMS */
    label { display: block; margin-top: 10px; font-weight: 600; color: #444; }
    input, select { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
    .action-btn { margin-top: 20px; background: #28a745; color: white; padding: 12px; border: none; border-radius: 5px; cursor: pointer; width: 100%; font-size: 16px; font-weight: bold; }

    /* TABLE */
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th { background: #0057b7; color: white; padding: 10px; text-align: left; }
    td { border-bottom: 1px solid #ddd; padding: 8px; vertical-align: middle; }
    
    /* STATUS & ICONS */
    .status-select { padding: 8px; font-weight: bold; border-radius: 4px; border: 1px solid #ccc; width: 100%; margin-bottom: 5px; }
    .btn-icon { text-decoration: none; font-size: 22px; margin-right: 15px; display: inline-block; transition: 0.2s; }
    .pick-btn { background: #0057b7; color: white; border: none; border-radius: 5px; width: 50px; cursor: pointer; font-size: 20px; margin-top: 5px; }
    
    /* DETAILED AI BOX */
    .ai-box { 
      background: #fdfdfd; 
      border: 1px solid #ddd;
      border-left: 5px solid #0057b7; 
      padding: 20px; 
      margin-top: 15px; 
      border-radius: 8px; 
      display: none; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      text-align: left;
    }
    .ai-header { font-size: 18px; font-weight: bold; color: #0057b7; margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
    .ai-section { margin-bottom: 15px; }
    .ai-subtitle { font-weight: bold; color: #333; margin-bottom: 5px; display: block; }
    .ai-text { color: #555; font-size: 14px; line-height: 1.6; }
    .ai-list { margin: 5px 0 0 20px; padding: 0; }
    .ai-list li { margin-bottom: 5px; }

  </style>
</head>

<body>

  <div id="loaderOverlay"><div class="spinner"></div><p>Please Wait...</p></div>

  <div id="uploadModal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal()">&times;</span>
      <h3>ЁЯУВ рд░рд┐рдкреЛрд░реНрдЯ рдЕрдкрд▓реЛрдб рдХрд░рд╛</h3>
      <p id="modalUserName" style="color:#0057b7; font-weight:bold;"></p>
      <input type="file" id="popupFile" style="border: 2px dashed #ccc; padding: 20px; width:100%; margin-top:10px;">
      <div id="popupProgressContainer" class="progress-container"><div id="popupProgressBar" class="progress-bar">0%</div></div>
      <button class="action-btn" onclick="uploadFromModal()">тмЖя╕П Upload Now</button>
      <input type="hidden" id="modalUserId">
    </div>
  </div>

  <div class="header">
    <h2>ЁЯЗоЁЯЗ│ Mission 1 Lakh (Full Analysis)</h2>
  </div>

  <div class="tab-btns">
    <button onclick="openTab('tab1', this)" class="active-btn">1. рдиреЛрдВрджрдгреА & BMI</button>
    <button onclick="openTab('tab2', this)">2. рдкреНрд▓реЕрдирд┐рдВрдЧ & рдЪреЗрдХ</button>
    <button onclick="openTab('tab3', this)">3. AI рд░рд┐рдкреЛрд░реНрдЯ</button>
    <button onclick="openTab('tab4', this)">4. рдбреЕрд╢рдмреЛрд░реНрдб</button>
  </div>

  <div id="tab1" class="tab active container">
    <h3>ЁЯУЭ рдирд╡реАрди рдирд╛рдЧрд░рд┐рдХ рдиреЛрдВрджрдгреА</h3>
    <label>рдкреВрд░реНрдг рдирд╛рд╡</label>
    <input type="text" id="inpName" placeholder="рдирд╛рд╡ рдЖрдкреЛрдЖрдк рдпреЗрдИрд▓ рдХрд┐рдВрд╡рд╛ рдЯрд╛рдЗрдк рдХрд░рд╛"/>
    <div style="display:flex; gap:10px;">
      <div style="flex:1"><label>рд╡рдп</label><input type="number" id="inpAge" placeholder="30"/></div>
      <div style="flex:1.5">
          <label>рдореЛрдмрд╛рдИрд▓</label>
          <div style="display:flex; gap:5px;">
            <input type="tel" id="inpMobile" placeholder="98XXXXXXXX" style="width:100%;"/>
            <button onclick="pickContact()" class="pick-btn">ЁЯУТ</button>
          </div>
      </div>
    </div>
    <div style="background:#f8f9fa; padding:15px; border-radius:8px; margin-top:15px; border:1px solid #ddd;">
      <h4 style="margin:0 0 10px 0; color:#0057b7;">тЪЦя╕П BMI рдХреЕрд▓реНрдХреНрдпреБрд▓реЗрдЯрд░</h4>
      <div style="display:flex; gap:10px;">
        <div style="flex:1"><label>рд╡рдЬрди (KG)</label><input type="number" id="inpWeight" oninput="calcBMI()"/></div>
        <div style="flex:1"><label>рдЙрдВрдЪреА (CM)</label><input type="number" id="inpHeight" oninput="calcBMI()"/></div>
      </div>
      <div id="bmiDisplay" style="margin-top:10px; font-weight:bold;">BMI: 0.0</div>
    </div>
    <button class="action-btn" onclick="savePerson()">ЁЯТ╛ рдорд╛рд╣рд┐рддреА рд╕реЗрд╡реНрд╣ рдХрд░рд╛</button>
  </div>

  <div id="tab2" class="tab container">
    <h3>ЁЯЧУя╕П рд╕реНрдЯреЗрдЯрд╕, рдкреНрд▓реЕрдирд┐рдВрдЧ рдЖрдгрд┐ рд╕рдВрдкрд░реНрдХ</h3>
    <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="ЁЯФН рдирд╛рд╡рд╛рдиреЗ рд╢реЛрдзрд╛..." style="padding:10px; width:100%; margin-bottom:15px; border: 2px solid #0057b7;">
    <div style="overflow-x:auto;">
      <table id="dataTable">
        <thead>
          <tr>
            <th>рдирд╛рд╡ / BMI</th>
            <th style="width: 28%;">рд╕реНрдЯреЗрдЯрд╕ (Action)</th>
            <th>рд╕рдВрдкрд░реНрдХ</th>
            <th>Del</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <div id="tab3" class="tab container">
    <h3>ЁЯдЦ AI рд░рд┐рдкреЛрд░реНрдЯ ре▓рдирд╛рд▓рд┐рд╕рд┐рд╕ (рд╕рд╡рд┐рд╕реНрддрд░)</h3>
    <p>рдпреЗрдереЗ рд░реБрдЧреНрдгрд╛рдЪрд╛ рд╕рдВрдкреВрд░реНрдг <b>рдЖрд╣рд╛рд░, рд╡реНрдпрд╛рдпрд╛рдо рдЖрдгрд┐ рдЖрд░реЛрдЧреНрдпрд╛рдЪрд╛ рд░рд┐рдкреЛрд░реНрдЯ</b> рддрдпрд╛рд░ рд╣реЛрдИрд▓.</p>
    <div style="overflow-x:auto;">
      <table id="analysisTable">
        <thead>
          <tr>
            <th>рдирд╛рд╡</th>
            <th>BMI Status</th>
            <th>AI рд╕рд▓реНрд▓рд╛ (Action)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <div id="tab4" class="tab container">
    <h3>ЁЯУК рдкреНрд░рдЧрддреА рдЕрд╣рд╡рд╛рд▓</h3>
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; text-align:center;">
      <div style="background:#eee; padding:15px; border-radius:10px; grid-column: span 2;">
        <h1 id="dTotal" style="margin:0;">0</h1><small>рдПрдХреВрдг рдиреЛрдВрджрдгреА</small>
      </div>
      <div style="background:#d4edda; padding:15px; border-radius:10px;">
        <h1 id="dDone" style="color:green; margin:0;">0</h1><small>тЬЕ рдЪреЗрдХ рдЭрд╛рд▓реЗ</small>
      </div>
      <div style="background:#f8d7da; padding:15px; border-radius:10px;">
        <h1 id="dPending" style="color:red; margin:0;">0</h1><small>рдмрд╛рдХреА</small>
      </div>
    </div>
    <button class="action-btn" style="background:#666;" onclick="loadPeople()">Refresh Data ЁЯФД</button>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, updateDoc, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAhg7nlZjHxOojoBZeBNIAjKhDwzXzr1io",
      authDomain: "swasth-80320.firebaseapp.com",
      projectId: "swasth-80320",
      storageBucket: "swasth-80320.firebasestorage.app",
      messagingSenderId: "143665591308",
      appId: "1:143665591308:web:99ce02ee034d041dd6ea29"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    const loader = document.getElementById("loaderOverlay");
    function showLoading() { loader.style.display = "flex"; }
    function hideLoading() { loader.style.display = "none"; }

    window.openTab = function(id, btn){
      document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('.tab-btns button').forEach(b=>b.classList.remove('active-btn'));
      if(btn) btn.classList.add('active-btn');
      if(id === 'tab3') loadAnalysisTab();
    };

    /* --- CONTACT & BMI --- */
    window.pickContact = async function() {
      if(!('contacts' in navigator)) return alert("Mobile Only");
      try {
        const c = await navigator.contacts.select(['name', 'tel'], {multiple:false});
        if(c.length){
           if(c[0].tel) document.getElementById("inpMobile").value = c[0].tel[0].replace(/\s/g, '');
           if(c[0].name) document.getElementById("inpName").value = c[0].name[0];
        }
      } catch(e){alert(e.message);}
    };

    window.calcBMI = function() {
      let w = parseFloat(document.getElementById("inpWeight").value);
      let h = parseFloat(document.getElementById("inpHeight").value);
      let d = document.getElementById("bmiDisplay");
      if(w>0 && h>0) {
        let bmi = (w/((h/100)*(h/100))).toFixed(1);
        let s = bmi<18.5?"Underweight":bmi<25?"Normal":"Overweight";
        let c = bmi<18.5?"orange":bmi<25?"green":"red";
        d.innerHTML = `BMI: ${bmi} <span style="color:${c}">(${s})</span>`;
        d.dataset.val=bmi; d.dataset.stat=s;
      }
    };

    /* --- SAVE --- */
    window.savePerson = async function(){
      const name = document.getElementById("inpName").value;
      const mobile = document.getElementById("inpMobile").value;
      const age = document.getElementById("inpAge").value;
      const bmiVal = document.getElementById("bmiDisplay").dataset.val || "0";
      const bmiStat = document.getElementById("bmiDisplay").dataset.stat || "-";
      
      if(!name || !mobile) { alert("рдирд╛рд╡ рдЖрдгрд┐ рдореЛрдмрд╛рдИрд▓ рднрд░рд╛!"); return; }
      showLoading();
      try {
        await addDoc(collection(db, "mission1lakh"), {
          name, mobile, age,
          weight: document.getElementById("inpWeight").value,
          height: document.getElementById("inpHeight").value,
          bmi: bmiVal, bmiStatus: bmiStat,
          status: "No", planDate: "", reportUrl: "",
          regDate: new Date().toLocaleDateString('en-IN')
        });
        alert("рд╕реЗрд╡реНрд╣ рдЭрд╛рд▓реЗ! тЬФ");
        document.querySelectorAll("input").forEach(i => i.value = "");
        loadPeople();
      } catch(e) { alert(e.message); } finally { hideLoading(); }
    };

    /* --- LOAD DATA --- */
    window.loadPeople = async function(){
      showLoading();
      const tbody = document.querySelector("#dataTable tbody");
      tbody.innerHTML = "";
      let total=0, done=0, pending=0;

      try {
        const snap = await getDocs(collection(db, "mission1lakh"));
        window.allPeople = [];
        snap.forEach(d => {
          let p = d.data(); p.id = d.id;
          window.allPeople.push(p);
          total++;
          if(p.status === "Yes") done++; else pending++;

          let row = tbody.insertRow();
          row.style.background = p.status==="Yes"?"#e8f5e9":p.status==="Planning"?"#fff3cd":"white";
          
          let planStyle = p.status==="Planning" ? "display:block" : "display:none";
          let msg = p.status==="Planning"?`рддрд╛рд░реАрдЦ ${p.planDate} рдард░рд▓реА рдЖрд╣реЗ.`:`рд░рд┐рдкреЛрд░реНрдЯ рддрдпрд╛рд░ рдЖрд╣реЗ.`;
          
          row.innerHTML = `
            <td><b>${p.name}</b><br><small>BMI: ${p.bmi}</small></td>
            <td>
              <select onchange="handleStatusChange('${p.id}', '${p.name}', this)" class="status-select">
                <option value="No" ${p.status==="No"?"selected":""}>тЭМ рдЪреЗрдХ рдирд╛рд╣реА</option>
                <option value="Planning" ${p.status==="Planning"?"selected":""}>ЁЯЧУя╕П рдкреНрд▓реЕрдирд┐рдВрдЧ</option>
                <option value="Yes" ${p.status==="Yes"?"selected":""}>тЬЕ рдЭрд╛рд▓реЗ (Done)</option>
              </select>
              <input type="date" id="date_${p.id}" value="${p.planDate||''}" style="${planStyle} width:100%; margin-top:5px;" onchange="updateDate('${p.id}',this.value)">
            </td>
            <td><a href="tel:${p.mobile}" class="btn-icon">ЁЯУЮ</a><a href="https://wa.me/91${p.mobile}?text=${encodeURIComponent(msg)}" target="_blank" class="btn-icon">ЁЯТЪ</a></td>
            <td><button onclick="deletePerson('${p.id}')" style="background:red; color:white; border:none; padding:5px;">X</button></td>
          `;
        });
        document.getElementById("dTotal").innerText = total;
        document.getElementById("dDone").innerText = done;
        document.getElementById("dPending").innerText = pending;
      } catch(e){console.error(e);} finally { hideLoading(); }
    };

    /* --- STATUS & UPLOAD --- */
    window.handleStatusChange = async function(id, name, el) {
      await updateDoc(doc(db, "mission1lakh", id), { status: el.value });
      if(el.value==="Planning") document.getElementById("date_"+id).style.display="block";
      else if(el.value==="Yes") {
        document.getElementById("date_"+id).style.display="none";
        document.getElementById("uploadModal").style.display="flex";
        document.getElementById("modalUserName").innerText="рд░реБрдЧреНрдг: "+name;
        document.getElementById("modalUserId").value=id;
        document.getElementById("popupProgressContainer").style.display="none";
      } else document.getElementById("date_"+id).style.display="none";
    };
    window.closeModal = () => document.getElementById("uploadModal").style.display="none";
    
    window.uploadFromModal = function() {
      let file = document.getElementById("popupFile").files[0];
      let id = document.getElementById("modalUserId").value;
      if(!file) return alert("File Select Kara");
      
      let pBar = document.getElementById("popupProgressBar");
      document.getElementById("popupProgressContainer").style.display="block";

      const task = uploadBytesResumable(ref(storage, "reports/"+file.name), file);
      task.on('state_changed', 
        (snap) => { pBar.style.width = ((snap.bytesTransferred/snap.totalBytes)*100)+"%"; },
        (err) => alert(err.message),
        () => {
          getDownloadURL(task.snapshot.ref).then(async (url) => {
             await updateDoc(doc(db, "mission1lakh", id), { reportUrl: url });
             alert("Upload Complete тЬФ"); closeModal();
          });
        }
      );
    };
    
    window.updateDate = async(id,v) => await updateDoc(doc(db,"mission1lakh",id),{planDate:v});
    window.deletePerson = async(id) => {if(confirm("Del?")){await deleteDoc(doc(db,"mission1lakh",id));loadPeople();}};

    /* --- DETAILED AI ANALYSIS LOGIC --- */
    window.loadAnalysisTab = function() {
      const tbody = document.querySelector("#analysisTable tbody");
      tbody.innerHTML = "";
      let list = window.allPeople.filter(p => p.status === "Yes");
      if(list.length === 0) { tbody.innerHTML="<tr><td colspan='3' align='center'>No Data</td></tr>"; return; }

      list.forEach(p => {
        let row = tbody.insertRow();
        let reportLink = p.reportUrl ? `<a href="${p.reportUrl}" target="_blank">ЁЯУД PDF</a>` : "No Report";
        row.innerHTML = `
          <td><b>${p.name}</b> (${p.age} рд╡рд░реНрд╖реЗ)<br>${reportLink}</td>
          <td><span style="color:${p.bmiStatus==='Normal'?'green':'red'}">${p.bmiStatus} (${p.bmi})</span></td>
          <td>
            <button class="action-btn" style="margin:0; padding:8px; font-size:12px;" onclick="generateDetailedReport('${p.id}', '${p.name}', ${p.bmi}, '${p.bmiStatus}', ${p.age})">
              ЁЯФН рд╕рд╡рд┐рд╕реНрддрд░ рд░рд┐рдкреЛрд░реНрдЯ (Analyze)
            </button>
            <div id="aiRes_${p.id}" class="ai-box"></div>
          </td>
        `;
      });
    };

    window.generateDetailedReport = function(id, name, bmi, status, age) {
      let box = document.getElementById("aiRes_"+id);
      box.style.display = "block";
      
      let diet = "", exercise = "", precaution = "", color="#333";
      
      // LOGIC FOR DETAILED REPORT
      if(status === "Underweight") {
        color = "#e65100"; // Orange
        diet = `
          <ul class="ai-list">
            <li>ЁЯеЬ <b>рдкреНрд░рдерд┐рдиреЗ (Protein):</b> рджреВрдз, рдЕрдВрдбреА, рд╕реЛрдпрд╛рдмреАрди, рдбрд╛рд│реА, рдкрдиреАрд░, рд╕реБрдХрд╛ рдореЗрд╡рд╛ (рдмрджрд╛рдо, рдХрд╛рдЬреВ) рдЦрд╛.</li>
            <li>ЁЯНМ <b>рдлрд│реЗ:</b> рдХреЗрд│реА, рдЪрд┐рдХреВ, рдЖрдВрдмрд╛ рдпрд╛рдВрд╕рд╛рд░рдЦреА рд╡рдЬрди рд╡рд╛рдврд╡рдгрд╛рд░реА рдлрд│реЗ рдЦрд╛.</li>
            <li>ЁЯНЫ <b>рдЬреЗрд╡рдг:</b> рджрд┐рд╡рд╕рд╛рддреВрди рей рдРрд╡рдЬреА рел-рем рд╡реЗрд│рд╛ рдереЛрдбреЗ рдереЛрдбреЗ рдЦрд╛. рддреВрдк рдЖрдгрд┐ рд▓реЛрдгреА рдЖрд╣рд╛рд░рд╛рдд рдареЗрд╡рд╛.</li>
          </ul>`;
        exercise = `рд╡рдЬрди рдЙрдЪрд▓рдгреНрдпрд╛рдЪреЗ рд╡реНрдпрд╛рдпрд╛рдо (Strength Training) рдХрд░рд╛. рдЬрд╛рд╕реНрдд рдХрд╛рд░реНрдбрд┐рдУ (рдзрд╛рд╡рдгреЗ) рдЯрд╛рд│рд╛.`;
        precaution = `рдЕрд╢рдХреНрддрдкрдгрд╛ рдЬрд╛рдгрд╡рд▓реНрдпрд╛рд╕ рдбреЙрдХреНрдЯрд░рд╛рдВрдХрдбреВрди Multivitamin рдШреНрдпрд╛. рд╡реЗрд│реЗрд╡рд░ рдЭреЛрдк рдШреНрдпрд╛.`;
      
      } else if (status === "Normal") {
        color = "#2e7d32"; // Green
        diet = `
          <ul class="ai-list">
            <li>ЁЯеЧ <b>рд╕рдорддреЛрд▓ рдЖрд╣рд╛рд░:</b> рд╣рд┐рд░рд╡реНрдпрд╛ рдкрд╛рд▓реЗрднрд╛рдЬреНрдпрд╛, рдлрд│реЗ рдЖрдгрд┐ рдХрдбрдзрд╛рдиреНрдпреЗ рдирд┐рдпрдорд┐рдд рдареЗрд╡рд╛.</li>
            <li>ЁЯТз <b>рдкрд╛рдгреА:</b> рджрд┐рд╡рд╕рд╛рд▓рд╛ рдХрд┐рдорд╛рди рей-рек рд▓рд┐рдЯрд░ рдкрд╛рдгреА рдкреНрдпрд╛.</li>
            <li>ЁЯЪл <b>рдЯрд╛рд│рд╛:</b> рдЬрд╛рд╕реНрдд рддреЗрд▓рдХрдЯ рдЖрдгрд┐ рдмрд╛рд╣реЗрд░реАрд▓ рдЬрдВрдХ рдлреВрдб рдЦрд╛рдгреЗ рдЯрд╛рд│рд╛.</li>
          </ul>`;
        exercise = `рджрд░рд░реЛрдЬ рейреж рдорд┐рдирд┐рдЯреЗ рдЪрд╛рд▓рдгреЗ, рдзрд╛рд╡рдгреЗ рдХрд┐рдВрд╡рд╛ рдпреЛрдЧрд╛рд╕рдиреЗ рдХрд░рд╛.`;
        precaution = `рд╕рдзреНрдпрд╛рдЪреЗ рд╡рдЬрди рдЯрд┐рдХрд╡реВрди рдареЗрд╡рдгреНрдпрд╛рдЪрд╛ рдкреНрд░рдпрддреНрди рдХрд░рд╛. рд╡рд░реНрд╖рд╛рддреВрди рдПрдХрджрд╛ рд░реВрдЯреАрди рдЪреЗрдХрдЕрдк рдХрд░рд╛.`;
      
      } else { // Overweight or Obese
        color = "#c62828"; // Red
        diet = `
          <ul class="ai-list">
            <li>ЁЯЪл <b>рд╡рд░реНрдЬреНрдп (Stop):</b> рд╕рд╛рдЦрд░, рдЧреЛрдб рдкрджрд╛рд░реНрде, рддреЗрд▓рдХрдЯ, рдореИрджрд╛ (рдмрд┐рд╕реНрдХрд┐рдЯреЗ/рдмреНрд░реЗрдб) рдкреВрд░реНрдг рдмрдВрдж рдХрд░рд╛.</li>
            <li>ЁЯеЧ <b>рдХрд╛рдп рдЦрд╛рд╡реЗ:</b> рдЬреЗрд╡рдгрд╛рдд релреж% рддрд╛рдЯ рд╕реЕрд▓рдб (рдХрд╛рдХрдбреА, рдЯреЛрдореЕрдЯреЛ) рдЕрд╕рд╛рд╡реЗ. рдЬреНрд╡рд╛рд░реА/рдмрд╛рдЬрд░реАрдЪреА рднрд╛рдХрд░реА рдЦрд╛.</li>
            <li>тШХ <b>рдкреЗрдп:</b> рдХреЛрдордЯ рдкрд╛рдгреА, рдЧреНрд░реАрди рдЯреА, рд▓рд┐рдВрдмреВ рдкрд╛рдгреА рдШреНрдпрд╛. рджреВрдз рдЖрдгрд┐ рдЪрд╣рд╛ рдХрдореА рдХрд░рд╛.</li>
          </ul>`;
        exercise = `рд╕рдХрд╛рд│реА рд╡реЗрдЧрд╛рдиреЗ рекрел рдорд┐рдирд┐рдЯреЗ рдЪрд╛рд▓рдгреЗ (Brisk Walk). рд╕реВрд░реНрдп рдирдорд╕реНрдХрд╛рд░ рдЖрдгрд┐ рд╕рд╛рдпрдХрд▓рд┐рдВрдЧ рдХрд░рд╛.`;
        precaution = `рд╣реГрджрдпрд╡рд┐рдХрд╛рд░ рдЖрдгрд┐ рдордзреБрдореЗрд╣рд╛рдЪрд╛ рдзреЛрдХрд╛ рдЕрд╕реВ рд╢рдХрддреЛ. рджрд░ рей рдорд╣рд┐рдиреНрдпрд╛рдВрдиреА BP рдЖрдгрд┐ Sugar рддрдкрд╛рд╕рд╛.`;
      }

      // Age based specific advice
      if(age > 50) {
        precaution += `<br>ЁЯФ┤ <b>рд╡рд┐рд╢реЗрд╖ рдЯреАрдк:</b> рд╡рдпрд╛рдиреБрд╕рд╛рд░ рд╣рд╛рдбреЗ рдард┐рд╕реВрд│ рд╣реЛрдК рд╢рдХрддрд╛рдд, рдХреЕрд▓реНрд╢рд┐рдпрдо рдпреБрдХреНрдд рдЖрд╣рд╛рд░ рдШреНрдпрд╛. рдЧреБрдбрдШреЗрджреБрдЦреА рдЕрд╕рд▓реНрдпрд╛рд╕ рдЪрд╛рд▓рддрд╛рдирд╛ рдХрд╛рд│рдЬреА рдШреНрдпрд╛.`;
      }

      box.style.borderLeftColor = color;
      box.innerHTML = `
        <div class="ai-header" style="color:${color}">ЁЯдЦ рдЖрд░реЛрдЧреНрдп рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд░рд┐рдкреЛрд░реНрдЯ</div>
        
        <div class="ai-section">
          <span class="ai-subtitle">ЁЯПе рдЖрд░реЛрдЧреНрдп рд╕реНрдерд┐рддреА:</span>
          <span class="ai-text">рд░реБрдЧреНрдг <b>${status}</b> рд╢реНрд░реЗрдгреАрдордзреНрдпреЗ рдЖрд╣реЗ (BMI: ${bmi}).</span>
        </div>

        <div class="ai-section">
          <span class="ai-subtitle">ЁЯеЧ рдЖрд╣рд╛рд░ рдпреЛрдЬрдирд╛ (Diet Plan):</span>
          <div class="ai-text">${diet}</div>
        </div>

        <div class="ai-section">
          <span class="ai-subtitle">ЁЯПГ рд╡реНрдпрд╛рдпрд╛рдо рд╕рд▓реНрд▓рд╛ (Exercise):</span>
          <span class="ai-text">${exercise}</span>
        </div>

        <div class="ai-section">
          <span class="ai-subtitle">тЪая╕П рд╡реИрджреНрдпрдХреАрдп рд╕рд▓реНрд▓рд╛ & рдХрд╛рд│рдЬреА:</span>
          <span class="ai-text">${precaution}</span>
        </div>
        
        <div style="font-size:11px; color:#999; margin-top:10px; border-top:1px dashed #ccc; padding-top:5px;">
          *рд╕реВрдЪрдирд╛: рд╣рд╛ рд░рд┐рдкреЛрд░реНрдЯ BMI рдЖрдгрд┐ рд╡рдпрд╛рд╡рд░ рдЖрдзрд╛рд░рд┐рдд AI рд╕рд▓реНрд▓рд╛ рдЖрд╣реЗ. рдХреГрдкрдпрд╛ рдЕрдВрддрд┐рдо рдЙрдкрдЪрд╛рд░рд╛рдВрд╕рд╛рдареА рдбреЙрдХреНрдЯрд░рд╛рдВрдирд╛ рднреЗрдЯрд╛.
        </div>
      `;
    };

    loadPeople();
  </script>
</body>
</html>
