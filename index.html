<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width,initial-scale=1.0,maximum-scale=1.0">
<title>рд╕реНрд╡рд╛рд╕реНрде рдХреНрд░рд╛рдВрддреА рд╡рд░реНрд╖ 2026 тАУ RCM Digital Mission</title>

<style>
/* GLOBAL */
body{
    font-family:Arial;
    margin:0;
    background:linear-gradient(180deg,#FFF5E6,#FFFFFF,#E8F5E9);
    overflow-x:hidden;
}

/* HEADER */
header{
    background:linear-gradient(90deg,#FF671F,#FFFFFF,#046A38);
    padding:18px;text-align:center;
    font-size:22px;font-weight:bold;
    border-bottom:4px solid #0A3D88;
}

/* NAV */
nav{
    display:flex;background:#ffffffdd;
    backdrop-filter:blur(6px);
    position:sticky;top:0;z-index:50;
    overflow-x:auto;border-bottom:1px solid #ddd;
}
nav button{
    flex:1;min-width:120px;
    padding:12px;font-size:14px;
    background:#fafafa;border:none;
    font-weight:bold;
}
nav button.active{
    background:#0A3D88;color:white;
}

/* SECTION BOX */
.section{
    display:none;padding:18px;max-width:100%;
}
.box{
    background:white;padding:18px;border-radius:12px;
    margin-bottom:18px;box-shadow:0 3px 12px rgba(0,0,0,0.15);
    border-left:6px solid #FF671F;
}

/* INPUTS */
input,select{
    width:100%;padding:12px;margin-top:8px;
    border:1px solid #ccc;border-radius:10px;
}

/* BUTTON */
.action{
    background:linear-gradient(90deg,#FF671F,#FFD9B3);
    padding:14px;width:100%;border:none;
    border-radius:10px;margin-top:12px;
    font-weight:bold;font-size:16px;color:#000;
}

/* CARDS */
.cardRow{display:flex;gap:10px;flex-wrap:wrap;}
.card{
    flex:1;min-width:150px;
    background:white;padding:15px;border-radius:12px;
    text-align:center;box-shadow:0 3px 10px #bbb;
    border-top:6px solid #046A38;
}
.card h2{
    color:#0A3D88;margin:5px 0;font-size:22px;
}

/* PROGRESS CIRCLE */
.progressCircle{
    width:100px;height:100px;border-radius:50%;
    border:8px solid #046A38;border-left-color:#FF671F;
    animation:spin 3s linear infinite;margin:auto;
}
@keyframes spin{
    from{transform:rotate(0deg);}
    to{transform:rotate(360deg);}
}

/* REPORT BOX */
.reportBox{
    background:white;padding:14px;border-radius:10px;
    margin-bottom:12px;box-shadow:0 2px 6px rgba(0,0,0,0.15);
    border-left:5px solid #0A3D88;
}

/* STATUS */
.pending{color:#d10000;font-weight:bold;}
.done{color:#046A38;font-weight:bold;}
.highRisk{color:#d10000;font-weight:bold;}
.normal{color:#046A38;font-weight:bold;}

/* EXPORT BUTTON */
.exportBtn{
    background:#0A3D88;color:white;padding:10px;
    border-radius:10px;border:none;width:100%;
    margin-bottom:12px;
}
</style>
</head>

<body>

<header>ЁЯЗоЁЯЗ│ рд╕реНрд╡рд╛рд╕реНрде рдХреНрд░рд╛рдВрддреА рд╡рд░реНрд╖ 2026 тАУ RCM Digital Mission</header>

<nav>
<button class="active" onclick="showSection('target')">рд▓рд┐рд╕реНрдЯ</button>
<button onclick="showSection('dash')">рдбреЕрд╢рдмреЛрд░реНрдб</button>
<button onclick="showSection('reg')">рдиреЛрдВрджрдгреА</button>
<button onclick="showSection('upload')">рд░рд┐рдкреЛрд░реНрдЯ рдЕрдкрд▓реЛрдб</button>
<button onclick="showSection('rep')">рд╕рд░реНрд╡ рд░рд┐рдкреЛрд░реНрдЯ</button>
<button onclick="showSection('follow')">рдлреЙрд▓реЛ-рдЕрдк</button>
</nav>


<!-- TARGET LIST -->
<div class="section" id="target" style="display:block;">

    <div class="box">
        <h3>ЁЯОп рд▓рд┐рд╕реНрдЯ (Target List)</h3>

        <input id="tname" placeholder="рдирд╛рд╡">
        <input id="tmobile" placeholder="рдореЛрдмрд╛рдИрд▓ рдирдВрдмрд░">
        <input id="tcity" placeholder="рд╢рд╣рд░">

        <select id="tstatus">
            <option>Pending</option>
            <option>Done</option>
        </select>

        <button class="action" onclick="saveTarget()">рд╕реЗрд╡реНрд╣ рдХрд░рд╛</button>
    </div>

    <button class="exportBtn" onclick="exportListPDF()">тмЗ рд▓рд┐рд╕реНрдЯ PDF рдбрд╛рдЙрдирд▓реЛрдб</button>

    <h3>ЁЯУМ рддреБрдордЪреА рд▓рд┐рд╕реНрдЯ</h3>
    <div id="targetList"></div>
</div>



<!-- DASHBOARD -->
<div class="section" id="dash">
    <center><div class="progressCircle"></div></center>

    <div class="cardRow">
        <div class="card">
            <h2 id="tPending">0</h2>
            <span>Pending</span>
        </div>

        <div class="card">
            <h2 id="tDone">0</h2>
            <span>Done</span>
        </div>

        <div class="card">
            <h2 id="totalReg">0</h2>
            <span>рдиреЛрдВрджрдгреА</span>
        </div>

        <div class="card">
            <h2 id="totalRep">0</h2>
            <span>рдЕрдкрд▓реЛрдб рд░рд┐рдкреЛрд░реНрдЯ</span>
        </div>
    </div>
</div>
<!-- REGISTRATION -->
<div class="section" id="reg">
    <div class="box">
        <h3>ЁЯзСтАНтЪХя╕П рдирд╡реА рдиреЛрдВрджрдгреА</h3>

        <input id="rname" placeholder="рдирд╛рд╡">
        <input id="rmobile" placeholder="рдореЛрдмрд╛рдИрд▓ рдирдВрдмрд░">
        <input id="rage" placeholder="рд╡рдп">
        <input id="rcity" placeholder="рд╢рд╣рд░">

        <button class="action" onclick="saveReg()">рд╕реЗрд╡реНрд╣ рдХрд░рд╛</button>
    </div>

    <button class="exportBtn" onclick="exportRegistrationPDF()">
        тмЗ рдиреЛрдВрджрдгреАрдЪрд╛ PDF рдбрд╛рдЙрдирд▓реЛрдб
    </button>

</div>



<!-- REPORT UPLOAD -->
<div class="section" id="upload">
    <div class="box">
        <h3>ЁЯУД PDF рд░рд┐рдкреЛрд░реНрдЯ рдЕрдкрд▓реЛрдб</h3>

        <input id="umobile" placeholder="рдореЛрдмрд╛рдИрд▓ рдирдВрдмрд░">

        <select id="utest">
            <option value="">рдЯреЗрд╕реНрдЯ рдирд┐рд╡рдбрд╛</option>
            <option>CBC</option>
            <option>Lipid</option>
            <option>HbA1c</option>
            <option>Liver</option>
            <option>Kidney</option>
            <option>Vitamin D</option>
            <option>Vitamin B12</option>
        </select>

        <input type="file" id="updf" accept="application/pdf">

        <button class="action" onclick="uploadPDF()">UPLOAD PDF</button>
    </div>
</div>



<!-- ALL REPORTS -->
<div class="section" id="rep">

    <h3>ЁЯУБ рд░рд┐рдкреЛрд░реНрдЯ тАУ PDF рдбрд╛рдЙрдирд▓реЛрдб</h3>

    <button class="exportBtn" onclick="exportListPDF()">тмЗ рд▓рд┐рд╕реНрдЯ рд░рд┐рдкреЛрд░реНрдЯ PDF</button>
    <button class="exportBtn" onclick="exportRegistrationPDF()">тмЗ рдиреЛрдВрджрдгреА рд░рд┐рдкреЛрд░реНрдЯ PDF</button>
    <button class="exportBtn" onclick="exportUploadedReportsPDF()">тмЗ рдЕрдкрд▓реЛрдб рдХреЗрд▓реЗрд▓реЗ рд░рд┐рдкреЛрд░реНрдЯ PDF</button>
    <button class="exportBtn" onclick="exportFollowupPDF()">тмЗ рдлреЙрд▓реЛ-рдЕрдк рд░рд┐рдкреЛрд░реНрдЯ PDF</button>

    <br><br>

    <h3>ЁЯУД рдЕрдкрд▓реЛрдб рдХреЗрд▓реЗрд▓реЗ рд░рд┐рдкреЛрд░реНрдЯ</h3>
    <div id="reportList"></div>
</div>



<!-- FOLLOW-UP -->
<div class="section" id="follow">
    <div class="box">
        <h3>ЁЯУЭ рдлреЙрд▓реЛ-рдЕрдк рдЕрдкрдбреЗрдЯ</h3>

        <input id="fm" placeholder="рдореЛрдмрд╛рдИрд▓ рдирдВрдмрд░">
        <input id="f1" placeholder="Day 1 рдиреЛрдЯреНрд╕">
        <input id="f15" placeholder="Day 15 рдиреЛрдЯреНрд╕">
        <input id="f30" placeholder="Day 30 рдиреЛрдЯреНрд╕">
        <input id="f60" placeholder="Day 60 рдиреЛрдЯреНрд╕">

        <button class="action" onclick="saveFollow()">рд╕реЗрд╡реНрд╣ рдХрд░рд╛</button>
    </div>
</div>



<!-- FIREBASE SCRIPTS -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>

<script>
/******** FIREBASE CONFIG *******/
firebase.initializeApp({
    apiKey:"AIzaSyAhg7nlZjHxOojoBZeBNIAjKhDwzXzr1io",
    authDomain:"swasth-80320.firebaseapp.com",
    projectId:"swasth-80320",
    storageBucket:"swasth-80320.appspot.com",
    messagingSenderId:"143665591308",
    appId:"1:143665591308:web:99ce02ee034d041dd6ea29",
    databaseURL:"https://swasth-80320-default-rtdb.asia-southeast1.firebasedatabase.app"
});
const db=firebase.database();
const storage=firebase.storage();



/******** SECTION SWITCH *******/    
function showSection(id){
    document.querySelectorAll(".section").forEach(s=>s.style.display="none");
    document.getElementById(id).style.display="block";

    document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
    event.target.classList.add("active");
}



/*************** TARGET LIST SAVE ****************/
function saveTarget(){
    let m=tmobile.value;

    db.ref("targets/"+m).set({
        name:tname.value,
        mobile:m,
        city:tcity.value,
        status:tstatus.value,
        time:Date.now()
    });

    alert("рд▓рд┐рд╕реНрдЯрдордзреНрдпреЗ рдиреЛрдВрдж рдЭрд╛рд▓реА тЬФ");
}



/*************** TARGET LIST LOAD ****************/
db.ref("targets").on("value",snap=>{
    let html="",pen=0,don=0;

    snap.forEach(t=>{
        let d=t.val();

        if(d.status=="Pending") pen++;
        if(d.status=="Done") don++;

        html+=`
        <div class='reportBox'>
            <h4>${d.name} (${d.mobile})</h4>
            <p>рд╢рд╣рд░: ${d.city}</p>
            <p>Status: 
                <span class="${d.status=='Done'?'done':'pending'}">${d.status}</span>
            </p>
        </div>`;
    });

    targetList.innerHTML=html;
    tPending.innerText=pen;
    tDone.innerText=don;
});



/*************** REGISTRATION SAVE ****************/
function saveReg(){
    let m=rmobile.value;

    db.ref("patients/"+m).set({
        name:rname.value,
        mobile:m,
        age:rage.value,
        city:rcity.value,
        time:Date.now()
    });

    alert("рдиреЛрдВрджрдгреА рдкреВрд░реНрдг тЬФ");
}



/*************** REPORT UPLOAD ****************/
function uploadPDF(){
    let m=umobile.value,
        t=utest.value,
        f=updf.files[0];

    if(!m||!t||!f){
        alert("рдкреВрд░реНрдг рдорд╛рд╣рд┐рддреА рднрд░рд╛");
        return;
    }

    let ref=storage.ref("reports/"+m+"/"+t+".pdf");

    ref.put(f).then(()=>{
        ref.getDownloadURL().then(url=>{
            db.ref("reports/"+m+"/"+t).set({
                mobile:m,test:t,url:url,time:Date.now()
            });
            alert("PDF рдЕрдкрд▓реЛрдб рдЭрд╛рд▓реЗ тЬФ");
        });
    });
}



/*************** REPORT LIST LOAD ****************/
db.ref("reports").on("value",snap=>{
    let html="";
    snap.forEach(u=>{
        u.forEach(r=>{
            let d=r.val();
            html+=`
            <div class='reportBox'>
                <h4>${d.mobile} тАУ ${d.test}</h4>
                <a href="${d.url}" target="_blank">PDF рдЙрдШрдбрд╛</a>
            </div>`;
        });
    });
    reportList.innerHTML=html;
});



/*************** FOLLOW-UP SAVE ****************/
function saveFollow(){
    db.ref("followup/"+fm.value).set({
        day1:f1.value,
        day15:f15.value,
        day30:f30.value,
        day60:f60.value,
        time:Date.now()
    });

    alert("рдлреЙрд▓реЛ-рдЕрдк рд╕реЗрд╡реНрд╣ рдЭрд╛рд▓реЗ тЬФ");
}



/*************** DASH COUNTS ****************/
db.ref("patients").on("value",s=>totalReg.innerText=s.numChildren());
db.ref("reports").on("value",s=>totalRep.innerText=s.numChildren());



/*************** PDF EXPORT FUNCTIONS ****************/

/* 1) Registration PDF */
function exportRegistrationPDF(){
    db.ref("patients").once("value",(snap)=>{
        let data="рдиреЛрдВрджрдгреА рд░рд┐рдкреЛрд░реНрдЯ\n\nрдирд╛рд╡,рдореЛрдмрд╛рдИрд▓,рд╡рдп,рд╢рд╣рд░\n";
        snap.forEach(p=>{
            let d=p.val();
            data+=`${d.name},${d.mobile},${d.age},${d.city}\n`;
        });
        downloadFile(data,"registration_report.pdf");
    });
}

/* 2) List (Target) PDF */
function exportListPDF(){
    db.ref("targets").once("value",(snap)=>{
        let data="рд▓рд┐рд╕реНрдЯ рд░рд┐рдкреЛрд░реНрдЯ\n\nрдирд╛рд╡,рдореЛрдмрд╛рдИрд▓,рд╢рд╣рд░,рд╕реНрдерд┐рддреА\n";
        snap.forEach(t=>{
            let d=t.val();
            data+=`${d.name},${d.mobile},${d.city},${d.status}\n`;
        });
        downloadFile(data,"list_report.pdf");
    });
}

/* 3) Uploaded Reports PDF */
function exportUploadedReportsPDF(){
    db.ref("reports").once("value",(snap)=>{
        let data="рдЕрдкрд▓реЛрдб рд░рд┐рдкреЛрд░реНрдЯ\n\nрдореЛрдмрд╛рдИрд▓,рдЯреЗрд╕реНрдЯ,PDF рд▓рд┐рдВрдХ\n";
        snap.forEach(u=>{
            u.forEach(r=>{
                let d=r.val();
                data+=`${d.mobile},${d.test},${d.url}\n`;
            });
        });
        downloadFile(data,"uploaded_reports.pdf");
    });
}

/* 4) Follow-Up PDF */
function exportFollowupPDF(){
    db.ref("followup").once("value",(snap)=>{
        let data="рдлреЙрд▓реЛ-рдЕрдк рд░рд┐рдкреЛрд░реНрдЯ\n\nрдореЛрдмрд╛рдИрд▓,Day1,Day15,Day30,Day60\n";
        snap.forEach(f=>{
            let d=f.val();
            data+=`${f.key},${d.day1},${d.day15},${d.day30},${d.day60}\n`;
        });
        downloadFile(data,"followup_report.pdf");
    });
}



/*************** DOWNLOAD HELPER ****************/
function downloadFile(data,filename){
    let blob=new Blob([data],{type:"text/plain"});
    let url=URL.createObjectURL(blob);
    let a=document.createElement("a");
    a.href=url;
    a.download=filename;
    a.click();
}

</script>

</body>
</html>
